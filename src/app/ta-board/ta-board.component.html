<div class="col-12">
    <div class="card">
        <h5>T&A Dashboard</h5>
      
		<p-table #dt1 [value]="tandAs" dataKey="id" [rows]="10" [loading]="loading" [rowHover]="true" styleClass="p-datatable-gridlines" [paginator]="true" [globalFilterFields]="['id','style','garment_tech_name','customer']" responsiveLayout="scroll">
			<ng-template pTemplate="caption">
				<div class="flex justify-content-between flex-column sm:flex-row">
					<button pButton label="Clear" class="p-button-outlined mb-2" icon="pi pi-filter-slash" (click)="clear(dt1)"></button>
					<span class="p-input-icon-left mb-2">
						<i class="pi pi-search"></i>
						<input pInputText type="text" #filter (input)="onGlobalFilter(dt1, $event)" placeholder="Search Keyword" class="w-full"/>
					</span>
				</div>
			</ng-template>
            <ng-template pTemplate="header">
                <tr>
                    <th style="width: 3rem"></th>
                    <th pSortableColumn="id">
						<div class="flex justify-content-between align-items-center">
							ID
							<p-columnFilter type="text" field="id" display="menu" placeholder="Search by name"></p-columnFilter>
						</div>
						<p-sortIcon field="id"></p-sortIcon></th>
                    <th pSortableColumn="style">
						<div class="flex justify-content-between align-items-center">
							Style
							<p-columnFilter type="text" field="style" display="menu" placeholder="Search by name"></p-columnFilter>
						</div>
					<p-sortIcon field="style"></p-sortIcon></th>
                    <th pSortableColumn="customer"> 
						<div class="flex justify-content-between align-items-center">
							Garment Tech
							<p-columnFilter type="text" field="customer" display="menu" placeholder="Search by name"></p-columnFilter>
						</div>
						<p-sortIcon field="customer"></p-sortIcon></th>
                    <th pSortableColumn="description">Description <p-sortIcon field="description"></p-sortIcon></th>
                    <th>Sketch</th>
                    <th pSortableColumn="garment_tech_name">
						<div class="flex justify-content-between align-items-center">
							Garment Tech
							<p-columnFilter type="text" field="garment_tech_name" display="menu" placeholder="Search by name"></p-columnFilter>
						</div>
						<p-sortIcon field="garment_tech_name"></p-sortIcon>
					
					</th>
                 
                    
                </tr>
            </ng-template>
            <ng-template pTemplate="body" let-tandARow let-expanded="expanded">
                <tr>
                    <td>
                        <button type="button" pButton pRipple [pRowToggler]="tandARow" class="p-button-text p-button-rounded p-button-plain" [icon]="expanded ? 'pi pi-chevron-down' : 'pi pi-chevron-right'"></button>
                    </td>
                    <td style="min-width: 12rem;">{{tandARow.id}}</td>
                    <td>{{tandARow.style}}</td>
                    <td>{{tandARow.customer}}</td>
                    <td>{{tandARow.description}}</td>
                    <td><img [src]="tandARow.sketch" [alt]="tandARow.description" width="50" height="50" class="shadow-4" /></td>
                    <td>{{tandARow.garment_tech_name}}</td>
                </tr>
            </ng-template>
            <ng-template pTemplate="rowexpansion" let-tandARow>
                <tr>
                    <td colspan="8">
                        <div class="p-3">
                            <p-table [value]="tandARow.stages" dataKey="id" responsiveLayout="scroll">
                                <ng-template pTemplate="header">
                                    <tr>
                                        <th pSortableColumn="id">Stage <p-sortIcon field="id"></p-sortIcon></th>
                                        <th pSortableColumn="name">Proto  <p-sortIcon field="name"></p-sortIcon></th>
										<th pSortableColumn="name">Fit  <p-sortIcon field="name"></p-sortIcon></th>
										<th pSortableColumn="name">Size Set  <p-sortIcon field="name"></p-sortIcon></th>
										<th pSortableColumn="name">PP planned  <p-sortIcon field="name"></p-sortIcon></th>
										<th pSortableColumn="name">PP actual  <p-sortIcon field="name"></p-sortIcon></th>
										<th pSortableColumn="name">Color Sample  <p-sortIcon field="name"></p-sortIcon></th>
                                        <!-- Add more headers based on Stage interface -->
                                    </tr>
                                </ng-template>
                                <ng-template pTemplate="body" let-stage>
                                    <tr>
                                        <td>{{stage.stage}}</td>
                                        <td>{{stage.proto_date |date: 'yy-MM-dd'}}</td>
										<td>{{stage.fit_date |date: 'yy-MM-dd'}}</td>
										<td>{{stage.size_set_date |date: 'yy-MM-dd'}}</td>
										<td>{{stage.pp_sample_date |date: 'yy-MM-dd'}}</td>
										<td>{{stage.pp_sample_actual_date |date: 'yy-MM-dd'}}</td>
										<td>{{stage.color_sample_date |date: 'yy-MM-dd'}}</td>

                                        <!-- Add more table cells based on Stage interface -->
                                    </tr>
                                </ng-template>
                                <ng-template pTemplate="emptymessage">
                                    <tr>
                                        <td colspan="8">There are no stages for this T&A Row.</td>
                                    </tr>
                                </ng-template>
                            </p-table>
                        </div>
                    </td>
                </tr>
            </ng-template>
        </p-table>
    </div>
    <div class="flex justify-content-end flex flex-wrap gap-2">
        <button pButton pRipple label="Add new Style" onclick=goto_taform()></button>
        <button pButton pRipple label="Add New T&A" ></button>       
    </div>
</div>
